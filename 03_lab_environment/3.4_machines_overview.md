## 3.4 Virtual Machines and Their Roles

### 3.4.1. Kali Linux – Attacking Machine

**Kali Linux** is designed for penetration testing and in this environment serves as the **attacking machine**, generating real attack scenarios.

- **Name:** KaliMachine  
- **IP:** 192.168.2.10  
- **Network:** 192.168.2.0/24 (vmnet2)  
- **Interface:** eth0  
- **Role:** attack simulation, artifact generation  
- **Monitoring:** passive (traffic analyzed via SPAN from `em4`)

---

### 3.4.2. Windows Server 2019 – DC, DNS, IIS

The **Windows Server 2019** machine is configured as a **domain controller (DC) for Active Directory**, as well as a **DNS** and **IIS (web)** server.  
It plays a key role in managing user identity and authentication within the `victimcorp` domain.  
It forms the **core of the victim infrastructure**, to which other client machines in the environment are joined.

- **Name:** Damian-DC  
- **IP:** 192.168.3.20  
- **Network:** 192.168.3.0/24 (vmnet3)  
- **Interface:** Ethernet0  
- **Domain group:** victimcorp  
- **Role:**  
  - Active Directory (DC)  
  - DNS  
  - IIS (web server)
- **Monitoring:**  
  - **Winlogbeat** – collects **Sysmon** and **Windows Event Log** data (system and security events, including domain controller logs)  
  - **Filebeat** – collects application logs from IIS  
  - **Elastic Defend** – EDR and security telemetry

---

### 3.4.3. Windows 10 – Domain Client

This machine represents a **standard employee workstation** joined to the **Active Directory domain** managed by Windows Server.  
This setup allows central management of security policies, users, and resources.  
It uses domain services and represents a **typical attack target** within the network.

- **Name:** KOMPUTER1-VC  
- **IP:** 192.168.3.10  
- **Network:** 192.168.3.0/24 (vmnet3)  
- **Interface:** Ethernet0  
- **Domain group:** victimcorp  
- **Role:** regular domain-joined workstation in `victimcorp`
- **Monitoring:**  
  - **Winlogbeat** – collects **Sysmon** and **Windows Event Log** (system and security logs)  
  - **Elastic Defend** – detects unauthorized operations and exploits

---

### 3.4.4. Ubuntu – HIDS Detection Machine (Wazuh)

**Wazuh** is a **Host-based Intrusion Detection System (HIDS)** that analyzes host logs and monitors file and configuration changes.  
This machine is responsible for processing data collected from agents installed on Windows hosts.

- **Name:** detectionmachine1  
- **IP:** 192.168.6.10  
- **Network:** 192.168.6.0/24 (vmnet6)  
- **Interface:** ens34  
- **Role:** integrity monitoring, security rules  
- **Collected data:** system logs, host alerts, FIM data

---

### 3.4.5. Ubuntu – SIEM Detection Machine

This is the **main SIEM machine** aggregating data using the **Elastic Stack** for **processing, correlation, and visualization** of events from across the environment.  
It receives data from **Windows Server** and **Windows 10** (via Winlogbeat), **IIS logs** (Filebeat), **EDR telemetry (Elastic Defend)**, **pfSense logs**, and **network data from Suricata and Zeek**.  
This enables **centralized log management** and **comprehensive analysis** of both host activity and network traffic — forming the core of threat detection in the lab.

- **Name:** detectionmachine2  
- **IP:** 192.168.6.20  
- **Network:** 192.168.6.0/24 (vmnet6)  
- **Interfaces:**  
  - `ens34` – management and log collection  
  - `ens33` – receiving SPAN traffic from the victim network
- **Role:**  
  - Aggregation and centralization of logs using Elastic Stack  
  - Creating dashboards  
  - Central point for visualization and correlation of events

This machine serves as the **core of the entire detection system**, responsible for the **final analysis and visualization of artifacts**.

---

### Topology Overview

This architecture provides **comprehensive conditions for IT security research, incident analysis, and detection testing** using various **SIEM and IDS tools**.  
The described components will be used in the following chapters to analyze specific attack scenarios and investigate artifacts in the logs.

The diagram presents the **detailed topology of the laboratory environment** created for this project.  
It shows all logical subnets, virtual machines, and their connections through the **pfSense router (central routing point)**, as well as the interfaces used for **passive network traffic monitoring (SPAN/mirror)** and the **log forwarding paths to the central detection system**.  
This graphical representation helps better understand the **relationships between components** and illustrates the **structure on which the experiments are based**.

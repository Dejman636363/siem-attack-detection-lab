## 7.2. Classification of Artifacts According to the Pyramid of Pain

To evaluate the **detection value of the identified artifacts**, they were classified according to the **Pyramid of Pain** concept proposed by David Bianco.  
This model organizes **Indicators of Compromise (IOCs)** by the **difficulty for an attacker to change them**.  
**The higher the level in the pyramid, the more valuable the artifact is from a threat analysis perspective** — and the more "pain" it causes the adversary when detected.

**Table 1: Classification of artifacts from the analysis according to the levels of the Pyramid of Pain by David Bianco**

| Pyramid Level      | Example Artifacts from the Analysis                                                                 | Detection Significance                                                                                 |
|---------------------|------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| **TTPs**             | Evidence of techniques: `schtasks (T1053)`, `regedit (T1547.001)`, `-EncodedCommand (T1027)`, `keylog_inject (T1056)` | Indicate the attacker’s **behaviors, not just tools**. Their detection enables building **behavioral rules**. **Hardest to change** for the attacker. |
| **Tools**            | Apollo agent, Mythic C2, Nmap, Hydra                                                                | Detecting a specific tool allows **quick identification of the attack type and malware family**.          |
| **Network Artifacts**| Attacker IP: `192.168.2.10`, **C2 communication (port 80)**, beaconing                               | **Very useful in network traffic detection**, but **relatively easy to change**.                          |
| **Host Artifacts**   | File paths (`update_service_Mal.exe`), **registry entries, scheduled tasks**                         | **High analytical value** — allow **identifying persistence and escalation points**.                      |
| **Domain Names**     | No domains used — only **local IP address**                                                          | Not present in this analysis — in real cases, **domain-based detection can be harder**.                   |
| **IP Addresses**     | `192.168.2.10` — attacker’s machine                                                                  | **Relevant, but easy to change**.                                                                        |
| **Hash Values**      | SHA-256: `532dcc580c1c75125d938215ee15b435a5e2746fbb8df6a26318b1a43f30eab1`                           | **Easiest to change** — after recompilation the file’s hash will be different.                            |


---

This classification shows that the **most valuable indicators for detection and response are the attacker’s techniques and behaviors (TTPs)**,  
as they are **much harder to disguise than simple artifacts like IP addresses or hashes**.

Therefore, an effective detection system should **not rely solely on comparing hashes or blocking individual IP addresses**, but instead focus on **recognizing behavioral patterns**, such as:

- Use of **encoded PowerShell commands** (`-EncodedCommand`)
- Attempts to establish **persistence** (`schtasks`, `regedit`)
- Activity of **network attack tools** (`nmap`, `hydra`)
- **Unusual file paths** and **processes running with SYSTEM privileges**

Understanding and classifying artifacts using the **Pyramid of Pain** is fundamental for:

- **building effective detection rules**
- and **prioritizing SOC team actions** during real security incidents.


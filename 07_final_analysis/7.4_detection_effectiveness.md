## 7.4. Evaluation of Detection Tools Effectiveness

As part of the attack scenario analysis, it was possible to observe the performance of various detection system components such as **Zeek, Suricata, Sysmon, Windows Event Log, FIM**, and the **Elastic Stack**.  
The goal of this section is to assess their **effectiveness in the context of the conducted attack**.

- **Zeek**  
  Demonstrated **high effectiveness in detecting network-level anomalies**.  
  It recorded **port scanning activity (Nmap)**, **brute-force attempts on RDP (Hydra)**, and **unusual HTTP connections** related to **Apollo agent communication with the C2 server**.  
  Its logs enabled the identification of **repeated beacons and data transfers within the Command and Control channel**.

- **Suricata**  
  Detected **specific threat signatures**, including **brute-force attempts** and **suspicious HTTP communication**.  
  Its strength lies in the **ability to quickly react to known attack patterns** and the **ease of creating signature-based rules**.

- **Sysmon + Windows Event Log**  
  Allowed **deep host-level analysis** of system activity, including:  
  - launching `powershell.exe` and `cmd.exe`,  
  - creating scheduled tasks,  
  - modifying the registry,  
  - creating new files,  
  - and detecting attempts to **manipulate Windows Defender settings**.

- **FIM (File Integrity Monitoring)**  
  Although it did not provide full contextual information, it **enabled fast and clear detection of new files, scheduled task entries, registry key changes, and file modifications**.  
  In a slightly different attack scenario, it **could play a key role**.

- **Elastic Stack**  
  Proved invaluable for **centralizing, correlating, and visualizing all logs**.  
  Thanks to **KQL queries**, **powerful filtering**, and an intuitive interface, it allowed:  
  - searching data from various sources,  
  - building visualizations,  
  - and identifying correlations between events.  
  In particular, **Kibana** provided:  
  - **ready-made, customizable dashboards**,  
  - **a wide range of analytical features**,  
  - and a **clear, intuitive interface** that greatly simplified navigation through complex data and accelerated incident analysis.

---

**Summary:**  
The applied set of tools enabled **successful detection of most techniques used by the attacker**.  
The **highest visibility** was provided by **Sysmon and Windows Event Log (host-level)** as well as **Zeek and Suricata (network-level)**.  
This was complemented by the **correlation and analysis capabilities of Elastic Stack**.  
The **ATT&CK Navigator map** presented in section 7.3, where **almost all attack steps were covered from a detection perspective**, serves as a **visual confirmation of the effectiveness of the deployed detection tools**.
